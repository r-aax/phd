\subsection{Сопряжение с конечно-объемными \\ газодинамическими решателями}\label{sec:text_1_gas}

При расчете обледенения крайне важным элементом данных является поле скоростей в области, окружающей рассматриваемую поверхность.
Поле скоростей вблизи поверхности влияет на движение жидкой пленки по поверхности, что существенным образом определяет картину обледенения.
Также при использовании модели вторичного увлажнения отскочившие от поверхности капли попадают в свободный поток, и поле скоростей необходимо для расчета траектории их движения и зоны вторичного выпадения.

При выборе газадинамического (CFD\label{abbr:cfd}) решателя для сопряжения с расчетным кодом обледения на поверхностной сетке стоит обратить внимание на следующие моменты.
Газодинамический решатель является внешним источником данных для расчетов обледенения поверхности, он запускается довольно редко и вычисленное им поле скоростей используется в неизменном виде несколько сотен или тысяч итераций.
Таким образом, при расчете поля скоростей нет необходимости учитывать турбулентность, а реализацию решателя следует выбрать исходя из требования минимизации времени его работы.
Учитывая это, не ставилась задача выбора оптимального газодинамического решателя \cite{Blazek2015CFD}, а использовались решатели, работающие с трехмерными блочно-структурированными расчетными сетками, ввиду их быстродействия.
Однако, при использовании блочно-структурированных расчетных сеток возникла проблема согласования этих сеток с поверхностью, на которой расчитывается обледенение.
Так как перестроение поверхности в процессе обледенения существенно изменяет ее геометрию, то это приводит к проблемам перестроения объемных сеток для газодинамического решателя.

Приведем краткое описание газодинамических решателей, использованных для вычисления поля скоростей вокруг поверхностной сетки при расчете обледенения.

Рассматривалась система уравнений Эйлера \cite{Kulikovsky2001Gas}
\begin{equation}\label{eqn:text_1_gas_system}
	\frac{\partial}{\partial t} U + \frac{\partial}{\partial x} F + \frac{\partial}{\partial y} G + \frac{\partial}{\partial z} H = 0 \\
\end{equation}

\begin{equation}
U = \begin{pmatrix}
	\rho \\
	\rho u \\
	\rho v \\
	\rho w \\
	E
\end{pmatrix}, \
F = \begin{pmatrix}
	\rho u \\
	\rho u^2 + p \\
	\rho u v \\
	\rho u w \\
	u (E + p)
\end{pmatrix}, \
G = \begin{pmatrix}
	\rho v \\
	\rho u v \\
	\rho v^2 + p \\
	\rho v w \\
	v (E + p)
\end{pmatrix}, \
H = \begin{pmatrix}
	\rho w \\
	\rho u w \\
	\rho v w \\
	\rho w^2 + p \\
	w (E + p)
\end{pmatrix}
\end{equation}

\begin{equation}
	E = \rho \left( \frac{V^2}{2} + e \right), \ V^2 + u^2 + v^2 + w^2, \ e(p, \rho) = \frac{p}{\rho (\gamma - 1)}
\end{equation}

В системе уравнений \eqref{eqn:text_1_gas_system} $U$ -- вектор консервативных переменных, $\rho$ -- давление, $u$, $v$, $w$ -- составляющие вектора скорости вдоль декартовых координат, $p$ -- давление, $e$ -- внутренняя энергия, $E$ -- полная энергия, $\gamma$ -- показатель адиабаты.

Система уравнений \eqref{eqn:text_1_gas_system} решалась на декартовой расчетной сетке с кубическими ячейками с помощью метода конечных объемов путем вычисления потоков консервативных величин $F$ через грани ячейки, перпендикулярные направлению сетки $X$, вектора $G$ через грани ячейки, перпендикулярные направлению сетки $Y$, вектора $H$ через грани ячейки, перпендикулярные направлению сетки $Z$:
\begin{equation}
	U_i^{n + 1} = U_i^n - \frac{\Delta t}{\Delta h}(F_{i + \frac{1}{2}} - F_{i - \frac{1}{2}} + G_{j + \frac{1}{2}} - G_{j - \frac{1}{2}} + H_{k + \frac{1}{2}} - H_{k - \frac{1}{2}})
\end{equation}

В первом применяемом решателе для вычисления потоков использовалась противопоточная схема Стегера-Уорминга \cite{Smirnova2018Euler}\label{term:steger_warming_scheme}, в которой потоки получаются следующим образом (на примере потока $F$):
\begin{equation}\label{eqn:text_1_gas_F}
	F_{i + \frac{1}{2}} = F_i^{+}(U_i^n) + F_i^{-}(U_{i + 1}^n)
\end{equation}

\begin{equation}\label{eqn:text_1_gas_F2}
	F^{\pm} = \frac{\rho}{2 \gamma}
	\begin{pmatrix}
		\lambda_1^{\pm} + 2(\gamma - 1)\lambda_2^{\pm} + \lambda_5^{\pm} \\
		(u - a)\lambda_1^{\pm} + 2(\gamma - 1)u\lambda_2^{\pm} + (u + a)\lambda_5^{\pm} \\
		v(\lambda_1^{\pm} + 2(\gamma - 1)\lambda_2^{\pm} + \lambda_5^{\pm}) \\
		w(\lambda_1^{\pm} + 2(\gamma - 1)\lambda_2^{\pm} + \lambda_5^{\pm}) \\
		(H - ua)\lambda_1^{\pm} + (\gamma - 1)V^2\lambda_2^{\pm} + (H + ua)\lambda_5^{\pm}
	\end{pmatrix}
\end{equation}

\begin{equation}
	\lambda_i^{\pm} = \frac{\lambda_i \pm |\lambda_i|}{2}, \ \lambda_1 = u - a, \ \lambda_2 = \lambda_3 = \lambda_4 = u, \ \lambda_5 = u + a, \ H = \frac{E + p}{\rho}
\end{equation}

Во втором применяемом решателе для той же системы уравнений \eqref{eqn:text_1_gas_system} на той же декартовой расчетной сетке с кубическими ячейками использовался метод Годунова \cite{Kulikovsky2001Gas}\label{term:godunov_method} на базе точного римановского решателя \cite{Borisov2018Riemann}\label{term:riemann_solver} (реализация точного римановского решателя на разных языках программирования доступна в \cite{Toro1999Riemann,riemannvecGithub}).

В качестве третьего решателя (применяемого уже для решения системы уравнений Навье-Стокса) использовался комбинированный метод высокого разрешения RANS/ILES \cite{Bendersky2014RANSILES}, работающий на криволинейных блочно-структурированных расчетных сетках и применяемый для расчета турбулентных течений.
Метод RANS/ILES является комбинацией расчета осредненных по Рейнольдсу уравнений Навье-Стокса (Reynolds averaged Navier-Stokes, RANS\label{abbr:rans}) вблизи поверхности, а вдали от нее ILES\label{abbr:iles} (implicit LES) -- метода моделирования крупных вихрей (large eddy simulation, LES\label{abbr:les}) с неявной подсеточной моделью турбулентности (subgrid scale, SGS\label{abbr:sgs}).
